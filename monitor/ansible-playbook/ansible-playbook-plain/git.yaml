---
- name: git module demo
  hosts: all
  # become: yes
  # become_user: root
  user: ubuntu

  vars:
    repo: "git@github.com:DevOpsTechscrum/Devops.git"
    dest: "~/devops/techscrum-monitor"
 
  tasks:
    - name: checkout git repo

      git:
        repo: "{{repo}}"
        dest: "{{dest}}"
        accept_hostkey: yes
        update: yes
        version: "monitor-ansible"
      environment:
        # GIT_SSH_COMMAND: "ssh -i $SSH_KEY"
        GIT_SSH_COMMAND: "echo '{{ private_key_content }}' > /home/ubuntu/githubkey && chmod 600 /home/ubuntu/githubkey && ssh -i /home/ubuntu/githubkey"
      